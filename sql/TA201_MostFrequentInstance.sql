create table entity_resolver_count as(

SELECT  "argumentClusterId",
        "argumentRawString",
        "argumentNistType",
        count("argumentId") as f_count,
        array_agg("argumentBadlyTranslatedString") as enStrings,
        NULL as resolved_string,
        0.0 as resolved_score,
        false as fromFuzzyMatching,
        NULL as resolved_type,

FROM fact f
GROUP BY "argumentClusterId", "argumentNistType", "argumentRawString"
HAVING count("argumentId") >= ALL
                                  (select count("argumentId")
                                   from fact
                                   where      "argumentClusterId"=f."argumentClusterId"
                                         and "argumentNistType"=f."argumentNistType"
                                         and NOT ("argumentRawString" = ANY(VALUES ('a'),
 ('about'),
 ('above'),
 ('after'),
 ('again'),
 ('against'),
 ('ain'),
 ('all'),
 ('am'),
 ('an'),
 ('and'),
 ('any'),
 ('are'),
 ('aren'),
 (E'aren''t'),
 ('as'),
 ('at'),
 ('be'),
 ('because'),
 ('been'),
 ('before'),
 ('being'),
 ('below'),
 ('between'),
 ('both'),
 ('but'),
 ('by'),
 ('can'),
 ('couldn'),
 (E'couldn''t'),
 ('d'),
 ('did'),
 ('didn'),
 (E'didn''t'),
 ('do'),
 ('does'),
 ('doesn'),
 (E'doesn''t'),
 ('doing'),
 ('don'),
 (E'don''t'),
 ('down'),
 ('during'),
 ('each'),
 ('few'),
 ('for'),
 ('from'),
 ('further'),
 ('had'),
 ('hadn'),
 (E'hadn''t'),
 ('has'),
 ('hasn'),
 (E'hasn''t'),
 ('have'),
 ('haven'),
 (E'haven''t'),
 ('having'),
 ('he'),
 ('her'),
 ('here'),
 ('hers'),
 ('herself'),
 ('him'),
 ('himself'),
 ('his'),
 ('how'),
 ('i'),
 ('if'),
 ('in'),
 ('into'),
 ('is'),
 ('isn'),
 (E'isn''t'),
 ('it'),
 (E'it''s'),
 ('its'),
 ('itself'),
 ('just'),
 ('ll'),
 ('m'),
 ('ma'),
 ('me'),
 ('mightn'),
 (E'mightn''t'),
 ('more'),
 ('most'),
 ('mustn'),
 (E'mustn''t'),
 ('my'),
 ('myself'),
 ('needn'),
 (E'needn''t'),
 ('no'),
 ('nor'),
 ('not'),
 ('now'),
 ('o'),
 ('of'),
 ('off'),
 ('on'),
 ('once'),
 ('only'),
 ('or'),
 ('other'),
 ('our'),
 ('ours'),
 ('ourselves'),
 ('out'),
 ('over'),
 ('own'),
 ('re'),
 ('s'),
 ('same'),
 ('shan'),
 (E'shan''t'),
 ('she'),
 (E'she''s'),
 ('should'),
 (E'should''ve'),
 ('shouldn'),
 (E'shouldn''t'),
 ('so'),
 ('some'),
 ('such'),
 ('t'),
 ('than'),
 ('that'),
 (E'that''ll'),
 ('the'),
 ('their'),
 ('theirs'),
 ('them'),
 ('themselves'),
 ('then'),
 ('there'),
 ('these'),
 ('they'),
 ('this'),
 ('those'),
 ('through'),
 ('to'),
 ('too'),
 ('under'),
 ('until'),
 ('up'),
 ('ve'),
 ('very'),
 ('was'),
 ('wasn'),
 (E'wasn''t'),
 ('we'),
 ('were'),
 ('weren'),
 (E'weren''t'),
 ('what'),
 ('when'),
 ('where'),
 ('which'),
 ('while'),
 ('who'),
 ('whom'),
 ('why'),
 ('will'),
 ('with'),
 ('won'),
 (E'won''t'),
 ('wouldn'),
 (E'wouldn''t'),
 ('y'),
 ('you'),
 (E'you''d'),
 (E'you''ll'),
 (E'you''re'),
 (E'you''ve'),
 ('your'),
 ('yours'),
 ('yourself'),
 ('yourselves'),
 ('could'),
 (E'he''d'),
 (E'he''ll'),
 (E'he''s'),
 (E'here''s'),
 (E'how''s'),
 (E'i''d'),
 (E'i''ll'),
 (E'i''m'),
 (E'i''ve'),
 (E'let''s'),
 ('ought'),
 (E'she''d'),
 (E'she''ll'),
 (E'that''s'),
 (E'there''s'),
 (E'they''d'),
 (E'they''ll'),
 (E'they''re'),
 (E'they''ve'),
 (E'we''d'),
 (E'we''ll'),
 (E'we''re'),
 (E'we''ve'),
 (E'what''s'),
 (E'when''s'),
 (E'where''s'),
 (E'who''s'),
 (E'why''s'),
 ('would')))
                                   group by "argumentRawString")
)
